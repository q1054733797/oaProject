<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>我的待办</title>
    <script src="../miniui/scripts/boot.js" type="text/javascript"></script>
    <style type="text/css">
        html, body{
            margin:0;padding:0;border:0;width:100%;height:100%;overflow:hidden;
        }
    </style>
</head>
<body>
    <div class="mini-fit">
        <div id="grid" class="mini-datagrid" style="width:100%;height:100%;"
             url="/getMyBacklog"  idField="id">
            <div property="columns">
                <div type="checkColumn"></div>
                <div field="name" align="center" headerAlign="center">任务名称</div>
                <div field="person" align="center" headerAlign="center">办理人</div>
                <div field="createTime" align="center" headerAlign="center" renderer="getTime">创建时间</div>
                <div align="center" headerAlign="center" renderer="getHandle">操作</div>
            </div>
        </div>
    </div>

    <script>
        mini.parse();

        var grid = mini.get("grid");

        grid.load();

        function getHandle() {
            return "<a style='color: blue;cursor:pointer' onclick='show()'>点击查看申请详情</a>";
        }

        function show() {
            var row = grid.getSelected();
            if (row){
                mini.open({
                    url:"/base/vacateManage/showVacate.html",
                    title:"请假详情",
                    width:500,
                    height:500,
                    onload:function () {
                        var frame = this.getIFrameEl();
                        frame.contentWindow.setData(row);
                    },
                    ondestroy:function (action) {
                        if ("ok" == action ){
                            grid.reload();
                        }
                    }
                });
            } else{
                mini.alert("请选择一条待办事项");
            }
        }

        function getTime(e) {
            var value = String(e.value);
            var date = mini.parseDate(value);
            return mini.formatDate(date, "yyyy-MM-dd");
        }
    </script>
</body>
</html>